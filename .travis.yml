sudo: false
language: python
cache: pip
python:
  - "3.6"
env:
  - BASEDIR="https://raw.githubusercontent.com/open-contracting/standard-maintenance-scripts/master"
matrix:
  include:
    - name: Default
    - name: YAJL
      addons:
        apt:
          packages:
          - libyajl-dev
install:
  - curl -s -S --retry 3 $BASEDIR/tests/install.sh | bash -
  - pip install .[test]
script:
  - curl -s -S --retry 3 $BASEDIR/tests/script.sh | bash -
  - coverage run --append --source=ocdskit -m pytest --vcr-record=none
  - pip install orjson
  - coverage run --append --source=ocdskit -m pytest --vcr-record=none
  - pip uninstall -y orjson
after_success:
  coveralls
